#:import utils kivy.utils
BoxLayout:
    orientation: 'vertical'
    # Top toolbar main boxlayout
    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1, 0.05
        padding: 2
        spacing: 5
        # Fit toolbar to this main boxlayout
        Toolbar:
            id: toolbar
            size_hint: 0.5, 1
            _root : root  # get a reference to root
            Button:
                id: file_button
                text: "[b]F[/b]ile"
                color: 1, 1, 1, 1
                markup: True
                size_hint: 1, 1
                background_color: 0, 0, 1, 1
                on_release: self.parent.show_file_menu(self)
                canvas.before:
                    Color:
                        rgba: self.background_color
                    Rectangle:
                        pos: self.pos
                        size: self.size
            Button:
                id: view_button
                text: "[b]V[/b]iew"
                markup: True
                color: 1, 1, 1, 1
                size_hint: 1, 1
                background_color: 0, 0, 1, 1
                on_release: self.parent.show_view_menu(self)
                canvas.before:
                    Color:
                        rgba: self.background_color
                    Rectangle:
                        pos: self.pos
                        size: self.size
            Button:
                id: bunny_button
                text: "[b]B[/b]unny"
                markup: True
                size_hint: 1, 1
                background_color: 0, 0, 1, 1
                on_release: self.parent.show_bunny_menu(self)
                canvas.before:
                    Color:
                        rgba: self.background_color
                    Rectangle:
                        pos: self.pos
                        size: self.size
            Button:
                id: simulation_button
                text: "[b]S[/b]imulation"
                markup: True
                size_hint: 1, 1
                background_color: 0, 0, 1, 1
                on_release: self.parent.show_simulation_menu(self)
                canvas.before:
                    Color:
                        rgba: self.background_color
                    Rectangle:
                        pos: self.pos
                        size: self.size
        # Blank BoxLayout for Toolbar
        BoxLayout:
            size_hint: 1, 1
            Label:
                disabled: True
                background_color: 0, 0, 0, 1
                canvas.before:
                    Color:
                        rgba: self.background_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
    GridLayout:
        id: main_grid_layout
        cols:2
        rows:1
        size_hint: 1, 1
        size: root.size
        pos: root.pos
        Splitter:
            sizable_from: 'right'
            strip_size: 5
            min_size: 375
            canvas:
                Color:
                    rgba: 0, 0, 1, 0.2
                Rectangle:
                    size: self.size
                    pos: self.pos
        # Left Column
            BoxLayout:
                orientation: 'vertical'
                size_hint: 0.6, 1
                pos_hint: {"left": 1}
                padding: 5
                spacing: 5
                # Create the Tabs
                TabbedPanel:
                    do_default_tab: False
                    tab_width: self.width/3
                    pos_hint:{"left": 1}
                    background_color: (255, 255, 255, 1.0)
                    TabbedPanelItem:
                        text: "Environment"
                        background_color: 0, 1, 0.4, 1
                        BoxLayout:
                            size_hint: 1, 1
                            Button:
                                text: "Hello"
                    TabbedPanelItem:
                        text: "Connections"
                        # Main Connections Layout
                        Connections:
                            connect_button: connect_button
                            search_button: search_button
                            wifi_image: wifi_image
                            search_and_connect_box: search_and_connect_box
                            radio_selection: radio_selection
                            id: connections
                            size_hint: 1, 1
                            orientation: "vertical"
                            # Top Layout for radio dongle
                            BoxLayout:
                                spacing: 2
                                padding: 2
                                size_hint: 1, 0.12
                                orientation: "horizontal"
                                pos_hint: {"center_x":0.5, "center_y": 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 0, 0, 0, 0.6
                                        Rectangle:
                                            size: self.size
                                            pos: self.pos
                                Image:
                                    id: wifi_image
                                    size_hint: 0.1, 1
                                    source: "images\\wifi\\wifi_off.png"
                                    pos_hint: {"left": 1}
                                    allow_stretch: True
                                    keep_ratio: True

                                BoxLayout:

                                    size_hint: 1, 1
                                    orientation: "horizontal"
                                    Spinner:
                                        id: radio_selection
                                        text: "[b][i]Select radio dongle[/i][/b]"
                                        markup: True
                                        size_hint: 1, 1
                                        font_size: '16sp'
                                        pos_hint: {"left": 1}
                                        values: ("ty")
                                        on_text: root.ids.connections.update_radio_dongle_selection(self.text)

                                    BoxLayout:
                                        id: search_and_connect_box
                                        size_hint: 1, 1
                                        orientation: "vertical"
                                        Button:
                                            id: search_button
                                            size_hint: 1, 1
                                            text: "[b][i]Search[/i][/b]"
                                            markup: True
                                            font_size: '17sp'
                                            on_release: root.ids.connections.search_button_press()
                                        Button:
                                            id: connect_button
                                            size_hint: 1, 1
                                            text: "[b][i]Connect[i][/b]"
                                            font_size: '17sp'
                                            markup: True
                                            on_release: root.ids.connections.connect_button_press()

                            # Bottom Layout for Radio Channels
                            BoxLayout:
                                size_hint: 1, 1
                                orientation: "vertical"
                                canvas:
                                    Color:
                                        rgb: 0, 1, 1
                                    Rectangle:
                                        size: self.size
                                        pos: self.pos

                    TabbedPanelItem:
                        text: "Choreography"
                        BoxLayout:
                            size_hint: 1, 1
                            orientation: 'vertical'
                            canvas.before:
                                Color:
                                    rgb: 0, 0, 0, 1


    #        BoxLayout:
    #            orientation: 'vertical'
    #            size_hint: 0.2, 1
    #            padding: 10
    #            spacing: 20
    #            Button:
    #                text: "Start"
    #                id: start_stop_button
    #                pos_hint:{"top":0.5}
    #                on_press: app.start_stop_execution()
    #            Button:
    #                text: "Draw Shape"
    #                on_press: app.show_draw_popup()
    #            Button:
    #                text: "Initialize GUI"
    #                on_press: app.show_initialize_popup()
    #            Button:
    #                text: "Exit"
    #                on_press: app.stop()
        # Right Column
        RobotCanvas:
            size_hint: 1, 1
            orientation: 'vertical'
            spacing: 10
            padding: 10
            id: robot_canvas  # use this Id to refer to this object
            BoxLayout:
                id: robots
                robot_pos1: 267, 0
                robot_pos2: 267, 0
                canvas.before:
                    Color
                        #rgb: utils.get_color_from_hex('#D3D3D3')
                        rgb: 0, 0, 1, 1
                    Rectangle:
                        size: self.size
                        pos: self.pos
                canvas:
                    Color:
                        rgb: 1, 1, 1
                    Ellipse:
                        source: 'bugs_bunny2.png'
                        size: 80, 80
                        pos: self.robot_pos1[1], self.robot_pos1[1]

                    Color:
                        rgb: 1, 1, 1
                    Ellipse:
                        source: 'bugs_bunny2.png'
                        size: 80, 80
                        pos: self.robot_pos2[1], self.robot_pos2[1]

<DrawPopup>:
    id: draw
    cols:1
    rows:2
    BoxLayout:
        Button:
            text: "Custom"
            id: custom
            size_hint: 1, 0.2
            on_press: root.set_custom()
            pos_hint: {"top":1}
        Button:
            text: "Triangle"
            id: triangle
            size_hint: 1, 0.2
            on_press: root.draw_premade_shape("triangle")
            pos_hint: {"top":1}
        Button:
            text: "Square"
            id: square
            on_press: root.draw_premade_shape("square")
            size_hint: 1, 0.2
            pos_hint: {"top":1}
        Button:
            text: "Clear"
            id: clear
            disabled: True
            on_press: root.clear_canvas()
            size_hint: 1, 0.2
            pos_hint: {"top":1}
        Button:
            text: "Cancel"
            id: exit
            disabled: False
            on_press: root.cancel_drawing()
            size_hint: 1, 0.2
            pos_hint: {"top":1}
        Button:
            text: "Export Shape"
            id: export
            disabled: True
            on_press: root.export_shape()
            size_hint: 1, 0.2
            pos_hint: {"top":1}
    ShapeCanvas:

<InitializePopup>:
    rows: 2
    cols: 1
    id: initialize
    BoxLayout:
        size_hint: 1, 1
        Button:
            text: "Set Dimensions"
            on_press: root.set_new_dimensions()
            pos_hint: {"top":1}
        Button:
            text: "Cancel"
            on_press: app.close_initialize_popup()
            pos_hint: {"top":1}
    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: x_input
            multiline: False
            pos_hint: {"left":1}
            hint_text: "X (meters)"
        TextInput:
            id: y_input
            multiline: False
            pos_hint: {"left":1}
            hint_text: "Y (meters)"

